<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User page</title>

</head>


<style>
    #userbtn {
        background-color: #0d57a0;
        color: white;
        padding: 5px 5px;
        margin: 8px 0;
        border: none;
        cursor: pointer;
        width: 12%;
    }</style>

<body style="background-color: #1aa8b9">
<div id="usersection" align="right">
    <button id="userbtn" type="button"></button>
</div>
<h1 style="color: #fefefe;margin-top: 2cm;font-size: large">Username</h1>
<h2 id="username"></h2>
<h1 style="color: #fefefe;margin-top: 2cm;font-size: large">Your ID</h1>
<h2 id="userID"></h2>
<h1 style="color: #fefefe;margin-top: 2cm;font-size: large">Email</h1>
<h2 id="email"></h2>
<h1 style="color: #fefefe;margin-top: 2cm;font-size: large">Authority</h1>
<h2 id="Aut"></h2>
<div style="margin-top: 80px">
<a href="/ChangePassword" target="_blank">Change your password </a>
    <br>
    <br>
    <a href="/ChangeEmail" target="_blamk">Change your Email</a>


</div>
</body>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
    function getCookie(c_name)
    {
        if (document.cookie.length>0)
        {
            c_start=document.cookie.indexOf(c_name + "=")
            if (c_start!=-1)
            {
                c_start=c_start + c_name.length+1
                c_end=document.cookie.indexOf(";",c_start)
                if (c_end==-1) c_end=document.cookie.length
                return unescape(document.cookie.substring(c_start,c_end))
            }
        }
        return ""
    }
    console.log("000000");
    var username = getCookie('username');
    console.log(username);
    var userbtn = document.getElementById('userbtn');
    if (username != "") {
        userbtn.appendChild(document.createTextNode('welcome '));
        userbtn.appendChild(document.createTextNode(username));
    } else {
        userbtn.appendChild(document.createTextNode('Login'));
    }
    //--
    var g;
    var res;
    var obj2 = {};
    obj2.username = username;
    $(function(callback) {

        res = $.ajax({
            url: '/UserPage',
            type: 'POST',
            dataType: 'json',
            data: JSON.stringify(obj2),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                callback(data);
            },
            error: function (error) {
                console.log(error);
            }

        })
        var res = res.done(function(result) {
            console.log(res.responseText);
            var obj = JSON.parse(res.responseText);
            document.getElementById("username").innerHTML=obj.username
            document.getElementById("userID").innerHTML = obj.id;
            document.getElementById("email").innerHTML = obj.email
            if(obj.authority == 0) {
                document.getElementById("Aut").innerHTML = "User";
            }
            else if(obj.authority == 1) {
                document.getElementById("Aut").innerHTML = "Certified user";
            }
            else if(obj.authority == 2) {
                document.getElementById("Aut").innerHTML = "Admin";
            }
        });
    });




</script>
</html>